---
title: "linear_estimation_part1"
author: "Richard Gong"
date: "11/21/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r, echo=FALSE, warning=FALSE}
library(pacman)
p_load(stargazer, dplyr, sandwich, car)
df <- read.csv("../data/p1_athlete_debuts.txt", sep = "\t")
```
# OLS Constant Medal Effect (-1 vs. 0)
```{r, warning=FALSE}
df_marg <- subset(df, Best_Indiv_Marg == -1 | Best_Indiv_Marg == 0)
df_marg$Country.f <- factor(df_marg$Country)
df_marg$Games_Year.f <- factor(df_marg$Games_Year)
df_marg$Marginal_Medal <- df_marg$Best_Indiv_Marg + 1
# Future Olympics as outcome
reg_fo_nofe <- lm(Future_Olympics ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg)
cov <- vcovCL(reg_fo_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nofe <- sqrt(diag(cov))
reg_fo_nocfe <- lm(Future_Olympics ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fo_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nocfe <- sqrt(diag(cov))
reg_fo_all <- lm(Future_Olympics ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fo_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_all <- sqrt(diag(cov))
# Future Medals as outcome
reg_fm_nofe <- lm(Future_Medals ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg)
cov <- vcovCL(reg_fm_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nofe <- sqrt(diag(cov))
reg_fm_nocfe <- lm(Future_Medals ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fm_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nocfe <- sqrt(diag(cov))
reg_fm_all <- lm(Future_Medals ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fm_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_all <- sqrt(diag(cov))
# Future Gold Medals as outcome
reg_fg_nofe <- lm(Future_Golds ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg)
cov <- vcovCL(reg_fg_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nofe <- sqrt(diag(cov))
reg_fg_nocfe <- lm(Future_Golds ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fg_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nocfe <- sqrt(diag(cov))
reg_fg_all <- lm(Future_Golds ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fg_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_all <- sqrt(diag(cov))
stargazer(reg_fo_nofe, reg_fo_nocfe, reg_fo_all, 
          reg_fm_nofe, reg_fm_nocfe, reg_fm_all,
          reg_fg_nofe, reg_fg_nocfe, reg_fg_all,
          se = list(robust_se_fo_nofe, robust_se_fo_nocfe, robust_se_fo_all, 
                    robust_se_fm_nofe, robust_se_fm_nocfe, robust_se_fm_all,
                    robust_se_fg_nofe, robust_se_fg_nocfe, robust_se_fg_all),
          type="latex", style="qje", 
          title="Constant Medal Effect (-1 vs. 0)", 
          dep.var.labels=c("Future Olympics", "Future Medals", "Future Gold Medals"), 
          covariate.labels=c("MarginalMedal","Age", "AgeSquared", "Events", "TeamEvent", "FutureHomeSame", "FutureHomeDiff"),
          add.lines=list(rep("",10), c('Year fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'), c('Country fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}')),
          notes="*** denotes significance at 1 percent, ** at 5 percent, and * at 10 percent. Standard errors are clustered at the Year-Country level.",
          notes.append = FALSE, notes.align = "l",
          omit=c("Country.f", "Games_Year.f" ,"Constant"), 
          omit.stat=c("LL","ser","f","rsq"), 
          report="vc*s", no.space=TRUE, align=TRUE,
          font.size = "footnotesize", column.sep.width = "-15pt",
          float.env = "sidewaystable",
          header = FALSE, out="tables/p1_constant10.tex")
```
# OLS Constant Medal Effect (-1 vs. 1)
```{r, warning=FALSE}
df_marg_1 <- subset(df, Best_Indiv_Marg == -1 | Best_Indiv_Marg == 1)
df_marg_1$Country.f <- factor(df_marg_1$Country)
df_marg_1$Games_Year.f <- factor(df_marg_1$Games_Year)
df_marg_1$Marginal_Medal <- (df_marg_1$Best_Indiv_Marg + 1) / 2
# Future Olympics as outcome
reg_fo_nofe <- lm(Future_Olympics ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_1)
cov <- vcovCL(reg_fo_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nofe <- sqrt(diag(cov))
reg_fo_nocfe <- lm(Future_Olympics ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fo_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nocfe <- sqrt(diag(cov))
reg_fo_all <- lm(Future_Olympics ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fo_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_all <- sqrt(diag(cov))
# Future Medals as outcome
reg_fm_nofe <- lm(Future_Medals ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_1)
cov <- vcovCL(reg_fm_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nofe <- sqrt(diag(cov))
reg_fm_nocfe <- lm(Future_Medals ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fm_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nocfe <- sqrt(diag(cov))
reg_fm_all <- lm(Future_Medals ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fm_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_all <- sqrt(diag(cov))
# Future Gold Medals as outcome
reg_fg_nofe <- lm(Future_Golds ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_1)
cov <- vcovCL(reg_fg_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nofe <- sqrt(diag(cov))
reg_fg_nocfe <- lm(Future_Golds ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fg_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nocfe <- sqrt(diag(cov))
reg_fg_all <- lm(Future_Golds ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fg_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_all <- sqrt(diag(cov))
stargazer(reg_fo_nofe, reg_fo_nocfe, reg_fo_all, 
          reg_fm_nofe, reg_fm_nocfe, reg_fm_all,
          reg_fg_nofe, reg_fg_nocfe, reg_fg_all,
          se = list(robust_se_fo_nofe, robust_se_fo_nocfe, robust_se_fo_all, 
                    robust_se_fm_nofe, robust_se_fm_nocfe, robust_se_fm_all,
                    robust_se_fg_nofe, robust_se_fg_nocfe, robust_se_fg_all),
          type="latex", style="qje", 
          title="Constant Medal Effect (-1 vs. 1)", 
          dep.var.labels=c("Future Olympics", "Future Medals", "Future Gold Medals"), 
          covariate.labels=c("MarginalMedal","Age", "AgeSquared", "Events", "TeamEvent", "FutureHomeSame", "FutureHomeDiff"),
          add.lines=list(rep("",10), c('Year fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'), c('Country fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}')),
          notes="*** denotes significance at 1 percent, ** at 5 percent, and * at 10 percent. Standard errors are clustered at the Year-Country level.",
          notes.append = FALSE, notes.align = "l",
          omit=c("Country.f", "Games_Year.f" ,"Constant"), 
          omit.stat=c("LL","ser","f","rsq"), 
          report="vc*s", no.space=TRUE, align=TRUE,
          font.size = "footnotesize", column.sep.width = "-15pt",
          float.env = "sidewaystable",
          header = FALSE, out="tables/p1_constant11.tex")
```
# OLS Constant Medal Effect (-1 vs. 2)
```{r, warning=FALSE}
df_marg_2 <- subset(df, Best_Indiv_Marg == -1 | Best_Indiv_Marg == 2)
df_marg_2$Country.f <- factor(df_marg_2$Country)
df_marg_2$Games_Year.f <- factor(df_marg_2$Games_Year)
df_marg_2$Marginal_Medal <- (df_marg_2$Best_Indiv_Marg + 1) / 3
# Future Olympics as outcome
reg_fo_nofe <- lm(Future_Olympics ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_2)
cov <- vcovCL(reg_fo_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nofe <- sqrt(diag(cov))
reg_fo_nocfe <- lm(Future_Olympics ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fo_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nocfe <- sqrt(diag(cov))
reg_fo_all <- lm(Future_Olympics ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fo_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_all <- sqrt(diag(cov))
# Future Medals as outcome
reg_fm_nofe <- lm(Future_Medals ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_2)
cov <- vcovCL(reg_fm_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nofe <- sqrt(diag(cov))
reg_fm_nocfe <- lm(Future_Medals ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fm_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nocfe <- sqrt(diag(cov))
reg_fm_all <- lm(Future_Medals ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fm_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_all <- sqrt(diag(cov))
# Future Gold Medals as outcome
reg_fg_nofe <- lm(Future_Golds ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_2)
cov <- vcovCL(reg_fg_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nofe <- sqrt(diag(cov))
reg_fg_nocfe <- lm(Future_Golds ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fg_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nocfe <- sqrt(diag(cov))
reg_fg_all <- lm(Future_Golds ~  Marginal_Medal + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fg_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_all <- sqrt(diag(cov))
stargazer(reg_fo_nofe, reg_fo_nocfe, reg_fo_all, 
          reg_fm_nofe, reg_fm_nocfe, reg_fm_all,
          reg_fg_nofe, reg_fg_nocfe, reg_fg_all,
          se = list(robust_se_fo_nofe, robust_se_fo_nocfe, robust_se_fo_all, 
                    robust_se_fm_nofe, robust_se_fm_nocfe, robust_se_fm_all,
                    robust_se_fg_nofe, robust_se_fg_nocfe, robust_se_fg_all),
          type="latex", style="qje", 
          title="Constant Medal Effect (-1 vs. 2)", 
          dep.var.labels=c("Future Olympics", "Future Medals", "Future Gold Medals"), 
          covariate.labels=c("MarginalMedal","Age", "AgeSquared", "Events", "TeamEvent", "FutureHomeSame", "FutureHomeDiff"),
          add.lines=list(rep("",10), c('Year fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'), c('Country fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}')),
          notes="*** denotes significance at 1 percent, ** at 5 percent, and * at 10 percent. Standard errors are clustered at the Year-Country level.",
          notes.append = FALSE, notes.align = "l",
          omit=c("Country.f", "Games_Year.f" ,"Constant"), 
          omit.stat=c("LL","ser","f","rsq"), 
          report="vc*s", no.space=TRUE, align=TRUE,
          font.size = "footnotesize", column.sep.width = "-15pt",
          float.env = "sidewaystable",
          header = FALSE, out="tables/p1_constant12.tex")
```
# OLS Heterogeneous Medal Effect Gender (-1 vs. 0)
```{r, warning=FALSE}
df_marg$Marginal_MedalXMale <- df_marg$Marginal_Medal * df_marg$Male
# Future Olympics as outcome
reg_fo_nofe <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg)
cov <- vcovCL(reg_fo_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_nocfe <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fo_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_all <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fo_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_all, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_all <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Medals as outcome
reg_fm_nofe <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg)
cov <- vcovCL(reg_fm_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_nocfe <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fm_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_all <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fm_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_all, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_all <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Gold Medals as outcome
reg_fg_nofe <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg)
cov <- vcovCL(reg_fg_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_nocfe <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fg_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_all <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fg_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_all, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_all <- round(tst$`Pr(>F)`[2], digits = 3)
stargazer(reg_fo_nofe, reg_fo_nocfe, reg_fo_all, 
          reg_fm_nofe, reg_fm_nocfe, reg_fm_all,
          reg_fg_nofe, reg_fg_nocfe, reg_fg_all,
          se = list(robust_se_fo_nofe, robust_se_fo_nocfe, robust_se_fo_all, 
                    robust_se_fm_nofe, robust_se_fm_nocfe, robust_se_fm_all,
                    robust_se_fg_nofe, robust_se_fg_nocfe, robust_se_fg_all),
          type="latex", style="qje", 
          title="Gender Heterogeneous Medal Effect (-1 vs. 0)", 
          dep.var.labels=c("Future Olympics", "Future Medals", "Future Gold Medals"), 
          covariate.labels=c("MarginalMedal", "Male", "MarginalMedal*Male (D)", "Age", "AgeSquared", "Events", "TeamEvent", "FutureHomeSame", "FutureHomeDiff"),
          add.lines=list(rep("",10), 
                         c('Year fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'), 
                         c('Country fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}'),
                         c('F-test: MarginalMedal+D = 0', paste0("\\multicolumn{1}{c}{",fp_fo_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_all,"}"),
                           paste0("\\multicolumn{1}{c}{",fp_fm_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_all,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_all,"}"))),
          notes=c("*** denotes significance at 1 percent, ** at 5 percent, and * at 10 percent. Standard errors are clustered at the Year-Country level.", "F-test p-value reported."),
          notes.append = FALSE, notes.align = "l",
          omit=c("Country.f", "Games_Year.f" ,"Constant"), 
          omit.stat=c("LL","ser","f","rsq"), 
          report="vc*s", no.space=TRUE, align=TRUE,
          font.size = "footnotesize", column.sep.width = "-15pt",
          float.env = "sidewaystable",
          header = FALSE, out="tables/p1_hetg10.tex")
```
# OLS Heterogeneous Medal Effect Gender (-1 vs. 1)
```{r, warning=FALSE}
df_marg_1$Marginal_MedalXMale <- df_marg_1$Marginal_Medal * df_marg_1$Male
# Future Olympics as outcome
reg_fo_nofe <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_1)
cov <- vcovCL(reg_fo_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_nocfe <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fo_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_all <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fo_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_all, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_all <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Medals as outcome
reg_fm_nofe <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_1)
cov <- vcovCL(reg_fm_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_nocfe <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fm_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_all <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fm_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_all, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_all <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Gold Medals as outcome
reg_fg_nofe <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_1)
cov <- vcovCL(reg_fg_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_nocfe <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fg_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_all <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fg_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_all, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_all <- round(tst$`Pr(>F)`[2], digits = 3)
stargazer(reg_fo_nofe, reg_fo_nocfe, reg_fo_all, 
          reg_fm_nofe, reg_fm_nocfe, reg_fm_all,
          reg_fg_nofe, reg_fg_nocfe, reg_fg_all,
          se = list(robust_se_fo_nofe, robust_se_fo_nocfe, robust_se_fo_all, 
                    robust_se_fm_nofe, robust_se_fm_nocfe, robust_se_fm_all,
                    robust_se_fg_nofe, robust_se_fg_nocfe, robust_se_fg_all),
          type="latex", style="qje", 
          title="Gender Heterogeneous Medal Effect (-1 vs. 1)", 
          dep.var.labels=c("Future Olympics", "Future Medals", "Future Gold Medals"), 
          covariate.labels=c("MarginalMedal", "Male", "MarginalMedal*Male (D)", "Age", "AgeSquared", "Events", "TeamEvent", "FutureHomeSame", "FutureHomeDiff"),
          add.lines=list(rep("",10), 
                         c('Year fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'), 
                         c('Country fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}'),
                         c('F-test: MarginalMedal+D = 0', paste0("\\multicolumn{1}{c}{",fp_fo_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_all,"}"),
                           paste0("\\multicolumn{1}{c}{",fp_fm_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_all,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_all,"}"))),
          notes=c("*** denotes significance at 1 percent, ** at 5 percent, and * at 10 percent. Standard errors are clustered at the Year-Country level.", "F-test p-value reported."),
          notes.append = FALSE, notes.align = "l",
          omit=c("Country.f", "Games_Year.f" ,"Constant"), 
          omit.stat=c("LL","ser","f","rsq"), 
          report="vc*s", no.space=TRUE, align=TRUE,
          font.size = "footnotesize", column.sep.width = "-15pt",
          float.env = "sidewaystable",
          header = FALSE, out="tables/p1_hetg11.tex")
```
# OLS Heterogeneous Medal Effect Gender (-1 vs. 2)
```{r, warning=FALSE}
df_marg_2$Marginal_MedalXMale <- df_marg_2$Marginal_Medal * df_marg_2$Male
# Future Olympics as outcome
reg_fo_nofe <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_2)
cov <- vcovCL(reg_fo_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_nocfe <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fo_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_all <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fo_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_all, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_all <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Medals as outcome
reg_fm_nofe <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_2)
cov <- vcovCL(reg_fm_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_nocfe <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fm_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_all <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fm_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_all, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_all <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Gold Medals as outcome
reg_fg_nofe <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_2)
cov <- vcovCL(reg_fg_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_nocfe <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fg_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_all <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fg_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_all, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_all <- round(tst$`Pr(>F)`[2], digits = 3)
stargazer(reg_fo_nofe, reg_fo_nocfe, reg_fo_all, 
          reg_fm_nofe, reg_fm_nocfe, reg_fm_all,
          reg_fg_nofe, reg_fg_nocfe, reg_fg_all,
          se = list(robust_se_fo_nofe, robust_se_fo_nocfe, robust_se_fo_all, 
                    robust_se_fm_nofe, robust_se_fm_nocfe, robust_se_fm_all,
                    robust_se_fg_nofe, robust_se_fg_nocfe, robust_se_fg_all),
          type="latex", style="qje", 
          title="Gender Heterogeneous Medal Effect (-1 vs. 2)", 
          dep.var.labels=c("Future Olympics", "Future Medals", "Future Gold Medals"), 
          covariate.labels=c("MarginalMedal", "Male", "MarginalMedal*Male (D)", "Age", "AgeSquared", "Events", "TeamEvent", "FutureHomeSame", "FutureHomeDiff"),
          add.lines=list(rep("",10), 
                         c('Year fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'), 
                         c('Country fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}'),
                         c('F-test: MarginalMedal+D = 0', paste0("\\multicolumn{1}{c}{",fp_fo_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_all,"}"),
                           paste0("\\multicolumn{1}{c}{",fp_fm_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_all,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_all,"}"))),
          notes=c("*** denotes significance at 1 percent, ** at 5 percent, and * at 10 percent. Standard errors are clustered at the Year-Country level.", "F-test p-value reported."),
          notes.append = FALSE, notes.align = "l",
          omit=c("Country.f", "Games_Year.f" ,"Constant"), 
          omit.stat=c("LL","ser","f","rsq"), 
          report="vc*s", no.space=TRUE, align=TRUE,
          font.size = "footnotesize", column.sep.width = "-15pt",
          float.env = "sidewaystable",
          header = FALSE, out="tables/p1_hetg12.tex")
```
# OLS Heterogeneous Medal Effect Season (-1 vs. 0)
```{r, warning=FALSE}
df_marg$Marginal_MedalXis_summer <- df_marg$Marginal_Medal * df_marg$is_summer
# Future Olympics as outcome
reg_fo_nofe <- lm(Future_Olympics ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg)
cov <- vcovCL(reg_fo_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fo_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_nocfe <- lm(Future_Olympics ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fo_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fo_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_all <- lm(Future_Olympics ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fo_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_all, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fo_all <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Medals as outcome
reg_fm_nofe <- lm(Future_Medals ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg)
cov <- vcovCL(reg_fm_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fm_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_nocfe <- lm(Future_Medals ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fm_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fm_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_all <- lm(Future_Medals ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fm_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_all, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fm_all <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Gold Medals as outcome
reg_fg_nofe <- lm(Future_Golds ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg)
cov <- vcovCL(reg_fg_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fg_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_nocfe <- lm(Future_Golds ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fg_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fg_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_all <- lm(Future_Golds ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg)
cov <- vcovCL(reg_fg_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_all, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fg_all <- round(tst$`Pr(>F)`[2], digits = 3)
stargazer(reg_fo_nofe, reg_fo_nocfe, reg_fo_all, 
          reg_fm_nofe, reg_fm_nocfe, reg_fm_all,
          reg_fg_nofe, reg_fg_nocfe, reg_fg_all,
          se = list(robust_se_fo_nofe, robust_se_fo_nocfe, robust_se_fo_all, 
                    robust_se_fm_nofe, robust_se_fm_nocfe, robust_se_fm_all,
                    robust_se_fg_nofe, robust_se_fg_nocfe, robust_se_fg_all),
          type="latex", style="qje", 
          title="Season Heterogeneous Medal Effect (-1 vs. 0)", 
          dep.var.labels=c("Future Olympics", "Future Medals", "Future Gold Medals"), 
          covariate.labels=c("MarginalMedal", "Summer", "MarginalMedal*Summer (S)", "Age", "AgeSquared", "Events", "TeamEvent", "FutureHomeSame", "FutureHomeDiff"),
          add.lines=list(rep("",10), 
                         c('Year fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'), 
                         c('Country fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}'),
                         c('F-test: MarginalMedal+S = 0', paste0("\\multicolumn{1}{c}{",fp_fo_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_all,"}"),
                           paste0("\\multicolumn{1}{c}{",fp_fm_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_all,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_all,"}"))),
          notes=c("*** denotes significance at 1 percent, ** at 5 percent, and * at 10 percent. Standard errors are clustered at the Year-Country level.", "F-test p-value reported."),
          notes.append = FALSE, notes.align = "l",
          omit=c("Country.f", "Games_Year.f" ,"Constant"), 
          omit.stat=c("LL","ser","f","rsq"), 
          report="vc*s", no.space=TRUE, align=TRUE,
          font.size = "footnotesize", column.sep.width = "-15pt",
          float.env = "sidewaystable",
          header = FALSE, out="tables/p1_hets10.tex")
```
# OLS Heterogeneous Medal Effect Season (-1 vs. 1)
```{r, warning=FALSE}
df_marg_1$Marginal_MedalXis_summer <- df_marg_1$Marginal_Medal * df_marg_1$is_summer
# Future Olympics as outcome
reg_fo_nofe <- lm(Future_Olympics ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_1)
cov <- vcovCL(reg_fo_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fo_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_nocfe <- lm(Future_Olympics ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fo_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fo_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_all <- lm(Future_Olympics ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fo_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_all, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fo_all <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Medals as outcome
reg_fm_nofe <- lm(Future_Medals ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_1)
cov <- vcovCL(reg_fm_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fm_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_nocfe <- lm(Future_Medals ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fm_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fm_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_all <- lm(Future_Medals ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fm_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_all, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fm_all <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Gold Medals as outcome
reg_fg_nofe <- lm(Future_Golds ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_1)
cov <- vcovCL(reg_fg_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fg_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_nocfe <- lm(Future_Golds ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fg_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fg_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_all <- lm(Future_Golds ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_1)
cov <- vcovCL(reg_fg_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_all, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fg_all <- round(tst$`Pr(>F)`[2], digits = 3)
stargazer(reg_fo_nofe, reg_fo_nocfe, reg_fo_all, 
          reg_fm_nofe, reg_fm_nocfe, reg_fm_all,
          reg_fg_nofe, reg_fg_nocfe, reg_fg_all,
          se = list(robust_se_fo_nofe, robust_se_fo_nocfe, robust_se_fo_all, 
                    robust_se_fm_nofe, robust_se_fm_nocfe, robust_se_fm_all,
                    robust_se_fg_nofe, robust_se_fg_nocfe, robust_se_fg_all),
          type="latex", style="qje", 
          title="Season Heterogeneous Medal Effect (-1 vs. 1)", 
          dep.var.labels=c("Future Olympics", "Future Medals", "Future Gold Medals"), 
          covariate.labels=c("MarginalMedal", "Summer", "MarginalMedal*Summer (S)", "Age", "AgeSquared", "Events", "TeamEvent", "FutureHomeSame", "FutureHomeDiff"),
          add.lines=list(rep("",10), 
                         c('Year fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'), 
                         c('Country fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}'),
                         c('F-test: MarginalMedal+S = 0', paste0("\\multicolumn{1}{c}{",fp_fo_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_all,"}"),
                           paste0("\\multicolumn{1}{c}{",fp_fm_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_all,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_all,"}"))),
          notes=c("*** denotes significance at 1 percent, ** at 5 percent, and * at 10 percent. Standard errors are clustered at the Year-Country level.", "F-test p-value reported."),
          notes.append = FALSE, notes.align = "l",
          omit=c("Country.f", "Games_Year.f" ,"Constant"), 
          omit.stat=c("LL","ser","f","rsq"), 
          report="vc*s", no.space=TRUE, align=TRUE,
          font.size = "footnotesize", column.sep.width = "-15pt",
          float.env = "sidewaystable",
          header = FALSE, out="tables/p1_hets11.tex")
```
# OLS Heterogeneous Medal Effect Season (-1 vs. 2)
```{r, warning=FALSE}
df_marg_2$Marginal_MedalXis_summer <- df_marg_2$Marginal_Medal * df_marg_2$is_summer
# Future Olympics as outcome
reg_fo_nofe <- lm(Future_Olympics ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_2)
cov <- vcovCL(reg_fo_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fo_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_nocfe <- lm(Future_Olympics ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fo_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fo_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_all <- lm(Future_Olympics ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fo_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_all, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fo_all <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Medals as outcome
reg_fm_nofe <- lm(Future_Medals ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_2)
cov <- vcovCL(reg_fm_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fm_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_nocfe <- lm(Future_Medals ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fm_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fm_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_all <- lm(Future_Medals ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fm_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_all, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fm_all <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Gold Medals as outcome
reg_fg_nofe <- lm(Future_Golds ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff, data = df_marg_2)
cov <- vcovCL(reg_fg_nofe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nofe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_nofe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fg_nofe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_nocfe <- lm(Future_Golds ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fg_nocfe, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_nocfe <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_nocfe, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fg_nocfe <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_all <- lm(Future_Golds ~  Marginal_Medal + is_summer + Marginal_MedalXis_summer + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_2)
cov <- vcovCL(reg_fg_all, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_all <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_all, vcov = cov, "Marginal_Medal+Marginal_MedalXis_summer=0")
fp_fg_all <- round(tst$`Pr(>F)`[2], digits = 3)
stargazer(reg_fo_nofe, reg_fo_nocfe, reg_fo_all, 
          reg_fm_nofe, reg_fm_nocfe, reg_fm_all,
          reg_fg_nofe, reg_fg_nocfe, reg_fg_all,
          se = list(robust_se_fo_nofe, robust_se_fo_nocfe, robust_se_fo_all, 
                    robust_se_fm_nofe, robust_se_fm_nocfe, robust_se_fm_all,
                    robust_se_fg_nofe, robust_se_fg_nocfe, robust_se_fg_all),
          type="latex", style="qje", 
          title="Season Heterogeneous Medal Effect (-1 vs. 2)", 
          dep.var.labels=c("Future Olympics", "Future Medals", "Future Gold Medals"), 
          covariate.labels=c("MarginalMedal", "Summer", "MarginalMedal*Summer (S)", "Age", "AgeSquared", "Events", "TeamEvent", "FutureHomeSame", "FutureHomeDiff"),
          add.lines=list(rep("",10), 
                         c('Year fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'), 
                         c('Country fixed effects','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{No}','\\multicolumn{1}{c}{Yes}'),
                         c('F-test: MarginalMedal+S = 0', paste0("\\multicolumn{1}{c}{",fp_fo_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_all,"}"),
                           paste0("\\multicolumn{1}{c}{",fp_fm_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_all,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_nofe,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_nocfe,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_all,"}"))),
          notes=c("*** denotes significance at 1 percent, ** at 5 percent, and * at 10 percent. Standard errors are clustered at the Year-Country level.", "F-test p-value reported."),
          notes.append = FALSE, notes.align = "l",
          omit=c("Country.f", "Games_Year.f" ,"Constant"), 
          omit.stat=c("LL","ser","f","rsq"), 
          report="vc*s", no.space=TRUE, align=TRUE,
          font.size = "footnotesize", column.sep.width = "-15pt",
          float.env = "sidewaystable",
          header = FALSE, out="tables/p1_hets12.tex")
```
# OLS Subsample Heterogeneous Medal Effect Gender (-1 vs. 0)
```{r, warning=FALSE}
df_marg_pre_ww2 <- subset(df_marg, Games_Year <= 1936)
df_marg_post_ww2 <- subset(df_marg, Games_Year > 1936 & Games_Year <= 1992)
df_marg_stag <- subset(df_marg, Games_Year > 1992)
# Future Olympics as outcome
reg_fo_pre_ww2 <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_pre_ww2)
cov <- vcovCL(reg_fo_pre_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_pre_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_pre_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_pre_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_post_ww2 <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_post_ww2)
cov <- vcovCL(reg_fo_post_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_post_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_post_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_post_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_stag <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_stag)
cov <- vcovCL(reg_fo_stag, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_stag <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_stag, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_stag <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Medals as outcome
reg_fm_pre_ww2 <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_pre_ww2)
cov <- vcovCL(reg_fm_pre_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_pre_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_pre_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_pre_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_post_ww2 <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_post_ww2)
cov <- vcovCL(reg_fm_post_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_post_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_post_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_post_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_stag <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_stag)
cov <- vcovCL(reg_fm_stag, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_stag <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_stag, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_stag <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Gold Medals as outcome
reg_fg_pre_ww2 <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_pre_ww2)
cov <- vcovCL(reg_fg_pre_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_pre_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_pre_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_pre_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_post_ww2 <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_post_ww2)
cov <- vcovCL(reg_fg_post_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_post_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_post_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_post_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_stag <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_stag)
cov <- vcovCL(reg_fg_stag, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_stag <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_stag, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_stag <- round(tst$`Pr(>F)`[2], digits = 3)
stargazer(reg_fo_pre_ww2, reg_fo_post_ww2, reg_fo_stag, 
          reg_fm_pre_ww2, reg_fm_post_ww2, reg_fm_stag,
          reg_fg_pre_ww2, reg_fg_post_ww2, reg_fg_stag,
          se = list(robust_se_fo_pre_ww2, robust_se_fo_post_ww2, robust_se_fo_stag, 
                    robust_se_fm_pre_ww2, robust_se_fm_post_ww2, robust_se_fm_stag, 
                    robust_se_fg_pre_ww2, robust_se_fg_post_ww2, robust_se_fg_stag),
          type="latex", style="qje", 
          title="Subsample Gender Heterogeneous Medal Effect (-1 vs. 0)", 
          dep.var.labels=c("Future Olympics", "Future Medals", "Future Gold Medals"), 
          column.labels=c("1896-1936", "1948-1992", "1994-2018", "1896-1936", "1948-1992", "1994-2018", "1896-1936", "1948-1992", "1994-2018"), 
          covariate.labels=c("MarginalMedal", "Male", "MarginalMedal*Male (D)", "Age", "AgeSquared", "Events", "TeamEvent", "FutureHomeSame", "FutureHomeDiff"),
          add.lines=list(rep("",10), 
                         c('Year fixed effects','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'), 
                         c('Country fixed effects','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'),
                         c('F-test: MarginalMedal+D = 0', paste0("\\multicolumn{1}{c}{",fp_fo_pre_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_post_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_stag,"}"),
                           paste0("\\multicolumn{1}{c}{",fp_fm_pre_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_post_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_stag,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_pre_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_post_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_stag,"}"))),
          notes=c("*** denotes significance at 1 percent, ** at 5 percent, and * at 10 percent. Standard errors are clustered at the Year-Country level.", "F-test p-value reported. The subsample time periods are Before WWII: 1896-1936, After WWII: 1948-1992, Staggered: 1994-2018."),
          notes.append = FALSE, notes.align = "l",
          omit=c("Country.f", "Games_Year.f" ,"Constant"), 
          omit.stat=c("LL","ser","f","rsq"), 
          report="vc*s", no.space=TRUE, align=TRUE,
          font.size = "footnotesize", column.sep.width = "-15pt",
          float.env = "sidewaystable",
          header = FALSE, out="tables/p1_sshetg10.tex")
```
# OLS Subsample Heterogeneous Medal Effect Gender (-1 vs. 1)
```{r, warning=FALSE}
df_marg_pre_ww2 <- subset(df_marg_1, Games_Year <= 1936)
df_marg_post_ww2 <- subset(df_marg_1, Games_Year > 1936 & Games_Year <= 1992)
df_marg_stag <- subset(df_marg_1, Games_Year > 1992)
# Future Olympics as outcome
reg_fo_pre_ww2 <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_pre_ww2)
cov <- vcovCL(reg_fo_pre_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_pre_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_pre_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_pre_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_post_ww2 <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_post_ww2)
cov <- vcovCL(reg_fo_post_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_post_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_post_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_post_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_stag <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_stag)
cov <- vcovCL(reg_fo_stag, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_stag <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_stag, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_stag <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Medals as outcome
reg_fm_pre_ww2 <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_pre_ww2)
cov <- vcovCL(reg_fm_pre_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_pre_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_pre_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_pre_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_post_ww2 <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_post_ww2)
cov <- vcovCL(reg_fm_post_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_post_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_post_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_post_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_stag <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_stag)
cov <- vcovCL(reg_fm_stag, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_stag <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_stag, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_stag <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Gold Medals as outcome
reg_fg_pre_ww2 <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_pre_ww2)
cov <- vcovCL(reg_fg_pre_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_pre_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_pre_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_pre_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_post_ww2 <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_post_ww2)
cov <- vcovCL(reg_fg_post_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_post_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_post_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_post_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_stag <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_stag)
cov <- vcovCL(reg_fg_stag, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_stag <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_stag, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_stag <- round(tst$`Pr(>F)`[2], digits = 3)
stargazer(reg_fo_pre_ww2, reg_fo_post_ww2, reg_fo_stag, 
          reg_fm_pre_ww2, reg_fm_post_ww2, reg_fm_stag,
          reg_fg_pre_ww2, reg_fg_post_ww2, reg_fg_stag,
          se = list(robust_se_fo_pre_ww2, robust_se_fo_post_ww2, robust_se_fo_stag, 
                    robust_se_fm_pre_ww2, robust_se_fm_post_ww2, robust_se_fm_stag, 
                    robust_se_fg_pre_ww2, robust_se_fg_post_ww2, robust_se_fg_stag),
          type="latex", style="qje", 
          title="Subsample Gender Heterogeneous Medal Effect (-1 vs. 1)", 
          dep.var.labels=c("Future Olympics", "Future Medals", "Future Gold Medals"), 
          column.labels=c("1896-1936", "1948-1992", "1994-2018", "1896-1936", "1948-1992", "1994-2018", "1896-1936", "1948-1992", "1994-2018"), 
          covariate.labels=c("MarginalMedal", "Male", "MarginalMedal*Male (D)", "Age", "AgeSquared", "Events", "TeamEvent", "FutureHomeSame", "FutureHomeDiff"),
          add.lines=list(rep("",10), 
                         c('Year fixed effects','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'), 
                         c('Country fixed effects','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'),
                         c('F-test: MarginalMedal+D = 0', paste0("\\multicolumn{1}{c}{",fp_fo_pre_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_post_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_stag,"}"),
                           paste0("\\multicolumn{1}{c}{",fp_fm_pre_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_post_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_stag,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_pre_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_post_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_stag,"}"))),
          notes=c("*** denotes significance at 1 percent, ** at 5 percent, and * at 10 percent. Standard errors are clustered at the Year-Country level.", "F-test p-value reported. The subsample time periods are Before WWII: 1896-1936, After WWII: 1948-1992, Staggered: 1994-2018."),
          notes.append = FALSE, notes.align = "l",
          omit=c("Country.f", "Games_Year.f" ,"Constant"), 
          omit.stat=c("LL","ser","f","rsq"), 
          report="vc*s", no.space=TRUE, align=TRUE,
          font.size = "footnotesize", column.sep.width = "-15pt",
          float.env = "sidewaystable",
          header = FALSE, out="tables/p1_sshetg11.tex")
```
# OLS Subsample Heterogeneous Medal Effect Gender (-1 vs. 2)
```{r, warning=FALSE}
df_marg_pre_ww2 <- subset(df_marg_2, Games_Year <= 1936)
df_marg_post_ww2 <- subset(df_marg_2, Games_Year > 1936 & Games_Year <= 1992)
df_marg_stag <- subset(df_marg_2, Games_Year > 1992)
# Future Olympics as outcome
reg_fo_pre_ww2 <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_pre_ww2)
cov <- vcovCL(reg_fo_pre_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_pre_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_pre_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_pre_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_post_ww2 <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_post_ww2)
cov <- vcovCL(reg_fo_post_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_post_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_post_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_post_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fo_stag <- lm(Future_Olympics ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_stag)
cov <- vcovCL(reg_fo_stag, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fo_stag <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fo_stag, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fo_stag <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Medals as outcome
reg_fm_pre_ww2 <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_pre_ww2)
cov <- vcovCL(reg_fm_pre_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_pre_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_pre_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_pre_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_post_ww2 <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_post_ww2)
cov <- vcovCL(reg_fm_post_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_post_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_post_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_post_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fm_stag <- lm(Future_Medals ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_stag)
cov <- vcovCL(reg_fm_stag, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fm_stag <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fm_stag, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fm_stag <- round(tst$`Pr(>F)`[2], digits = 3)
# Future Gold Medals as outcome
reg_fg_pre_ww2 <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_pre_ww2)
cov <- vcovCL(reg_fg_pre_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_pre_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_pre_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_pre_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_post_ww2 <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_post_ww2)
cov <- vcovCL(reg_fg_post_ww2, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_post_ww2 <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_post_ww2, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_post_ww2 <- round(tst$`Pr(>F)`[2], digits = 3)
reg_fg_stag <- lm(Future_Golds ~  Marginal_Medal + Male + Marginal_MedalXMale + Age + Age_Sq + Events + Team_Event + Future_Home_Same + Future_Home_Diff + Country.f + Games_Year.f, data = df_marg_stag)
cov <- vcovCL(reg_fg_stag, cluster = ~ Country + Games_Year, type = "HC1")
robust_se_fg_stag <- sqrt(diag(cov))
tst <- linearHypothesis(reg_fg_stag, vcov = cov, "Marginal_Medal+Marginal_MedalXMale=0")
fp_fg_stag <- round(tst$`Pr(>F)`[2], digits = 3)
stargazer(reg_fo_pre_ww2, reg_fo_post_ww2, reg_fo_stag, 
          reg_fm_pre_ww2, reg_fm_post_ww2, reg_fm_stag,
          reg_fg_pre_ww2, reg_fg_post_ww2, reg_fg_stag,
          se = list(robust_se_fo_pre_ww2, robust_se_fo_post_ww2, robust_se_fo_stag, 
                    robust_se_fm_pre_ww2, robust_se_fm_post_ww2, robust_se_fm_stag, 
                    robust_se_fg_pre_ww2, robust_se_fg_post_ww2, robust_se_fg_stag),
          type="latex", style="qje", 
          title="Subsample Gender Heterogeneous Medal Effect (-1 vs. 2)", 
          dep.var.labels=c("Future Olympics", "Future Medals", "Future Gold Medals"), 
          column.labels=c("1896-1936", "1948-1992", "1994-2018", "1896-1936", "1948-1992", "1994-2018", "1896-1936", "1948-1992", "1994-2018"), 
          covariate.labels=c("MarginalMedal", "Male", "MarginalMedal*Male (D)", "Age", "AgeSquared", "Events", "TeamEvent", "FutureHomeSame", "FutureHomeDiff"),
          add.lines=list(rep("",10), 
                         c('Year fixed effects','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'), 
                         c('Country fixed effects','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}','\\multicolumn{1}{c}{Yes}'),
                         c('F-test: MarginalMedal+D = 0', paste0("\\multicolumn{1}{c}{",fp_fo_pre_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_post_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fo_stag,"}"),
                           paste0("\\multicolumn{1}{c}{",fp_fm_pre_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_post_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fm_stag,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_pre_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_post_ww2,"}"), paste0("\\multicolumn{1}{c}{",fp_fg_stag,"}"))),
          notes=c("*** denotes significance at 1 percent, ** at 5 percent, and * at 10 percent. Standard errors are clustered at the Year-Country level.", "F-test p-value reported. The subsample time periods are Before WWII: 1896-1936, After WWII: 1948-1992, Staggered: 1994-2018."),
          notes.append = FALSE, notes.align = "l",
          omit=c("Country.f", "Games_Year.f" ,"Constant"), 
          omit.stat=c("LL","ser","f","rsq"), 
          report="vc*s", no.space=TRUE, align=TRUE,
          font.size = "footnotesize", column.sep.width = "-15pt",
          float.env = "sidewaystable",
          header = FALSE, out="tables/p1_sshetg12.tex")
```

